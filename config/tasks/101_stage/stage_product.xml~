<?xml version="1.0"?>
<task>

	<name>stage_product</name>
	<blocker>true</blocker>

	<parameter>
		<name>last_modified_date</name>
		<default>1900-01-01 00:00:00</default>
		<query>
			<![CDATA[
				select max(Modified_Date) as last_modified_date 
				from ${TARGET_TABLE_NAME}
			]]>
		</query>
	</parameter>
	<source>
		<type>DB</type>
		<query>

			<![CDATA[
				SELECT
					ProductID
					,Name
					,MakeFlag
					,FinishedGoodsFlag
					,Color
					,StandardCost
					,ListPrice
					,Size
					,SizeUnitMeasureCode
					,WeightUnitMeasureCode
					,Weight
					,ProductLine
					,Class
					,Style
					,ProductSubcategoryID
					,ProductModelID
					,cast(SellStartDate as char) as Sell_Start_Date
					,cast(SellEndDate as char) as Sell_End_Date
					,cast(DiscontinuedDate as char) as Discontinued_Date
					,cast(ModifiedDate as char) as Modified_Date
FROM product
	Where ModifiedDate > '${last_modified_date}'
			]]>
		</query>
	</source>

	<transform>
		<transformation>dummy.ktr</transformation>
	</transform>

	<target>
		<loader>MySQL</loader>
		<table>
			<name>stage_product</name>
		</table>
	</target>


</task>
